{
  "run_name": "pyramid_tm",
  "metadata": {
    "model_name": "pyramid",
    "epochs": 1,
    "lr": 0.0008,
    "min_lr": 0.0001,
    "weight_decay": 1e-05,
    "grad_clip": 0.5,
    "grad_accum": 1,
    "tau_start": 0.6,
    "tau_end": 0.3,
    "warmup_epochs": 2,
    "stage_configs": [
      {
        "pool_size": 28,
        "projection_dim": 256,
        "n_clauses": 256,
        "tau": 0.6,
        "dropout": 0.05,
        "clause_pool": "mean",
        "logit_norm": "sqrt"
      },
      {
        "pool_size": 14,
        "projection_dim": 192,
        "n_clauses": 192,
        "tau": 0.6,
        "dropout": 0.05,
        "clause_pool": "mean",
        "logit_norm": "sqrt"
      },
      {
        "pool_size": 7,
        "projection_dim": 128,
        "n_clauses": 160,
        "tau": 0.6,
        "dropout": 0.05,
        "clause_pool": "mean",
        "logit_norm": "sqrt"
      },
      {
        "pool_size": 1,
        "projection_dim": 96,
        "n_clauses": 128,
        "tau": 0.6,
        "dropout": 0.0,
        "clause_pool": "mean",
        "logit_norm": "sqrt"
      }
    ],
    "seed": 123,
    "device": "cuda",
    "attention_heads": 2,
    "use_clause_attention": true,
    "use_scale_attention": true,
    "scale_entropy_weight": 0.01,
    "ema_decay": 0.0,
    "input_noise_std": 0.0,
    "tm_variant": "pyramid",
    "export_path": null,
    "patch_size": 4,
    "batch_multiplier": 1
  },
  "epochs": [
    {
      "epoch": 1,
      "train_loss": 2.3120779823392694,
      "train_accuracy": 0.10975,
      "eval_accuracy": 0.2091,
      "duration_s": 23.00050687789917,
      "diagnostics": {
        "tau": {
          "stages.0.tm": 0.6,
          "stages.1.tm": 0.6,
          "stages.2.tm": 0.6,
          "stages.3.tm": 0.6
        },
        "clause_sparsity": {
          "stages.0.tm": {
            "positive": 0.48040771484375,
            "negative": 0.47210693359375,
            "positive_inv": 0.489715576171875,
            "negative_inv": 0.49017333984375,
            "overall": 0.48310089111328125
          },
          "stages.1.tm": {
            "positive": 0.49169921875,
            "negative": 0.4921875,
            "positive_inv": 0.475640207529068,
            "negative_inv": 0.4772678017616272,
            "overall": 0.4841986894607544
          },
          "stages.2.tm": {
            "positive": 0.47919923067092896,
            "negative": 0.49003908038139343,
            "positive_inv": 0.4793945252895355,
            "negative_inv": 0.4837890565395355,
            "overall": 0.48310548067092896
          },
          "stages.3.tm": {
            "positive": 0.43017578125,
            "negative": 0.4542643427848816,
            "positive_inv": 0.4348958432674408,
            "negative_inv": 0.4464518427848816,
            "overall": 0.4414469599723816
          }
        },
        "attention": {
          "root": [
            0.29697373509407043,
            0.3110660910606384,
            0.19410547614097595,
            0.19785471260547638
          ]
        }
      },
      "extra": {
        "lr": 0.0004,
        "best_test_acc": 0.2091,
        "world_size": 1
      }
    }
  ]
}