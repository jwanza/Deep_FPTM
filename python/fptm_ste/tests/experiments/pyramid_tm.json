{
  "run_name": "pyramid_tm",
  "metadata": {
    "model_name": "pyramid",
    "epochs": 3,
    "lr": 0.0008,
    "min_lr": 0.0001,
    "weight_decay": 1e-05,
    "grad_clip": 0.5,
    "grad_accum": 1,
    "tau_start": 0.6,
    "tau_end": 0.3,
    "warmup_epochs": 2,
    "stage_configs": [
      {
        "pool_size": 28,
        "projection_dim": 256,
        "n_clauses": 256,
        "tau": 0.6,
        "dropout": 0.05,
        "clause_pool": "mean",
        "logit_norm": "sqrt"
      },
      {
        "pool_size": 14,
        "projection_dim": 192,
        "n_clauses": 192,
        "tau": 0.6,
        "dropout": 0.05,
        "clause_pool": "mean",
        "logit_norm": "sqrt"
      },
      {
        "pool_size": 7,
        "projection_dim": 128,
        "n_clauses": 160,
        "tau": 0.6,
        "dropout": 0.05,
        "clause_pool": "mean",
        "logit_norm": "sqrt"
      },
      {
        "pool_size": 1,
        "projection_dim": 96,
        "n_clauses": 128,
        "tau": 0.6,
        "dropout": 0.0,
        "clause_pool": "mean",
        "logit_norm": "sqrt"
      }
    ],
    "seed": 123,
    "device": "cuda",
    "attention_heads": 2,
    "use_clause_attention": true,
    "use_scale_attention": true,
    "scale_entropy_weight": 0.01,
    "ema_decay": 0.0,
    "input_noise_std": 0.0,
    "tm_variant": "pyramid",
    "export_path": null,
    "patch_size": 4,
    "batch_multiplier": 1,
    "virtual_batch_multiplier": 4
  },
  "epochs": [
    {
      "epoch": 1,
      "train_loss": 2.1594541018080506,
      "train_accuracy": 0.15327857905982906,
      "eval_accuracy": 0.2795,
      "duration_s": 41.48617243766785,
      "diagnostics": {
        "tau": {
          "stages.0.tm": 0.6,
          "stages.1.tm": 0.6,
          "stages.2.tm": 0.6,
          "stages.3.tm": 0.6
        },
        "clause_sparsity": {
          "stages.0.tm": {
            "positive": 0.4951171875,
            "negative": 0.497833251953125,
            "positive_inv": 0.498565673828125,
            "negative_inv": 0.496917724609375,
            "overall": 0.49710845947265625
          },
          "stages.1.tm": {
            "positive": 0.4927842915058136,
            "negative": 0.49072265625,
            "positive_inv": 0.4794379472732544,
            "negative_inv": 0.4851345419883728,
            "overall": 0.4870198667049408
          },
          "stages.2.tm": {
            "positive": 0.47119140625,
            "negative": 0.4554687440395355,
            "positive_inv": 0.4696289002895355,
            "negative_inv": 0.453125,
            "overall": 0.46235352754592896
          },
          "stages.3.tm": {
            "positive": 0.1368815153837204,
            "negative": 0.1529947966337204,
            "positive_inv": 0.0978190153837204,
            "negative_inv": 0.1072591170668602,
            "overall": 0.1237386092543602
          }
        },
        "attention": {
          "root": [
            0.3413163423538208,
            0.3837401866912842,
            0.13489407300949097,
            0.14004944264888763
          ]
        }
      },
      "extra": {
        "lr": 0.0004,
        "best_test_acc": 0.2795,
        "world_size": 1
      }
    },
    {
      "epoch": 2,
      "train_loss": 0.9784651755267738,
      "train_accuracy": 0.6341145833333334,
      "eval_accuracy": 0.8311,
      "duration_s": 45.01543998718262,
      "diagnostics": {
        "tau": {
          "stages.0.tm": 0.44999999999999996,
          "stages.1.tm": 0.44999999999999996,
          "stages.2.tm": 0.44999999999999996,
          "stages.3.tm": 0.44999999999999996
        },
        "clause_sparsity": {
          "stages.0.tm": {
            "positive": 0.49169921875,
            "negative": 0.491851806640625,
            "positive_inv": 0.494232177734375,
            "negative_inv": 0.489410400390625,
            "overall": 0.49179840087890625
          },
          "stages.1.tm": {
            "positive": 0.4842122495174408,
            "negative": 0.4841579794883728,
            "positive_inv": 0.47412109375,
            "negative_inv": 0.4782986044883728,
            "overall": 0.4801974892616272
          },
          "stages.2.tm": {
            "positive": 0.4296875,
            "negative": 0.4149414002895355,
            "positive_inv": 0.42304688692092896,
            "negative_inv": 0.40888673067092896,
            "overall": 0.41914063692092896
          },
          "stages.3.tm": {
            "positive": 0.1302083432674408,
            "negative": 0.1484375,
            "positive_inv": 0.0890299528837204,
            "negative_inv": 0.10107421875,
            "overall": 0.1171875
          }
        },
        "attention": {
          "root": [
            0.1758989542722702,
            0.7013416886329651,
            0.056659262627363205,
            0.06610008329153061
          ]
        }
      },
      "extra": {
        "lr": 0.0008,
        "best_test_acc": 0.8311,
        "world_size": 1
      }
    },
    {
      "epoch": 3,
      "train_loss": 0.46255382591396826,
      "train_accuracy": 0.8880208333333334,
      "eval_accuracy": 0.8908,
      "duration_s": 39.96380066871643,
      "diagnostics": {
        "tau": {
          "stages.0.tm": 0.3,
          "stages.1.tm": 0.3,
          "stages.2.tm": 0.3,
          "stages.3.tm": 0.3
        },
        "clause_sparsity": {
          "stages.0.tm": {
            "positive": 0.491241455078125,
            "negative": 0.4908447265625,
            "positive_inv": 0.493804931640625,
            "negative_inv": 0.4888916015625,
            "overall": 0.4911956787109375
          },
          "stages.1.tm": {
            "positive": 0.4828559160232544,
            "negative": 0.4832356870174408,
            "positive_inv": 0.4729275107383728,
            "negative_inv": 0.4775390625,
            "overall": 0.4791395366191864
          },
          "stages.2.tm": {
            "positive": 0.4273437559604645,
            "negative": 0.41162109375,
            "positive_inv": 0.42119142413139343,
            "negative_inv": 0.4058593809604645,
            "overall": 0.41650390625
          },
          "stages.3.tm": {
            "positive": 0.1302083432674408,
            "negative": 0.1484375,
            "positive_inv": 0.0890299528837204,
            "negative_inv": 0.10107421875,
            "overall": 0.1171875
          }
        },
        "attention": {
          "root": [
            0.1593015193939209,
            0.7292259335517883,
            0.051342789083719254,
            0.06012982502579689
          ]
        }
      },
      "extra": {
        "lr": 0.0001,
        "best_test_acc": 0.8908,
        "world_size": 1
      }
    }
  ]
}