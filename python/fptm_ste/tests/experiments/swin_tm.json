{
  "run_name": "swin_tm",
  "metadata": {
    "model_name": "swin",
    "epochs": 1,
    "lr": 0.0005,
    "min_lr": 0.0005,
    "weight_decay": 1e-05,
    "grad_clip": 0.5,
    "grad_accum": 1,
    "tau_start": 0.6,
    "tau_end": 0.3,
    "warmup_epochs": 0,
    "stage_configs": [
      {
        "embed_dim": 96,
        "depth": 2,
        "window_size": 4,
        "shift_size": 0,
        "tm_hidden_dim": 256,
        "tm_clauses": 256,
        "head_clauses": 256,
        "tau": 0.6,
        "dropout": 0.05,
        "clause_pool": "mean",
        "logit_norm": "sqrt"
      },
      {
        "embed_dim": 192,
        "depth": 2,
        "window_size": 4,
        "shift_size": 2,
        "tm_hidden_dim": 256,
        "tm_clauses": 256,
        "head_clauses": 256,
        "tau": 0.6,
        "dropout": 0.05,
        "clause_pool": "mean",
        "logit_norm": "sqrt"
      },
      {
        "embed_dim": 384,
        "depth": 4,
        "window_size": 4,
        "shift_size": 0,
        "tm_hidden_dim": 256,
        "tm_clauses": 256,
        "head_clauses": 256,
        "tau": 0.6,
        "dropout": 0.05,
        "clause_pool": "mean",
        "logit_norm": "sqrt"
      },
      {
        "embed_dim": 768,
        "depth": 2,
        "window_size": 4,
        "shift_size": 2,
        "tm_hidden_dim": 256,
        "tm_clauses": 256,
        "head_clauses": 256,
        "tau": 0.6,
        "dropout": 0.05,
        "clause_pool": "mean",
        "logit_norm": "sqrt"
      }
    ],
    "seed": 123,
    "device": "cpu",
    "attention_heads": 2,
    "use_clause_attention": true,
    "use_scale_attention": true,
    "scale_entropy_weight": 0.01,
    "ema_decay": 0.0,
    "input_noise_std": 0.0,
    "tm_variant": "swin",
    "export_path": null,
    "patch_size": 4,
    "batch_multiplier": 1,
    "virtual_batch_multiplier": 1,
    "stage_aux_weight": 0.25,
    "swin_tm_preset": "tiny",
    "resnet_tm_variant": "18"
  },
  "epochs": [
    {
      "epoch": 1,
      "train_loss": 2.6509063381121867,
      "train_accuracy": 0.21625,
      "eval_accuracy": 0.4752,
      "duration_s": 1521.3933010101318,
      "diagnostics": {
        "tau": {
          "stages.0.blocks.0.tm": 0.6,
          "stages.0.blocks.1.tm": 0.6,
          "stages.0.head_tm": 0.6,
          "stages.1.blocks.0.tm": 0.6,
          "stages.1.blocks.1.tm": 0.6,
          "stages.1.head_tm": 0.6,
          "stages.2.blocks.0.tm": 0.6,
          "stages.2.blocks.1.tm": 0.6,
          "stages.2.blocks.2.tm": 0.6,
          "stages.2.blocks.3.tm": 0.6,
          "stages.2.head_tm": 0.6,
          "stages.3.blocks.0.tm": 0.6,
          "stages.3.blocks.1.tm": 0.6,
          "stages.3.head_tm": 0.6,
          "head": 0.6
        },
        "clause_sparsity": {
          "stages.0.blocks.0.tm": {
            "positive": 0.536529541015625,
            "negative": 0.529205322265625,
            "positive_inv": 0.530487060546875,
            "negative_inv": 0.5294189453125,
            "overall": 0.5314102172851562
          },
          "stages.0.blocks.1.tm": {
            "positive": 0.523956298828125,
            "negative": 0.517425537109375,
            "positive_inv": 0.517791748046875,
            "negative_inv": 0.521759033203125,
            "overall": 0.520233154296875
          },
          "stages.0.head_tm": {
            "positive": 0.507110595703125,
            "negative": 0.49859619140625,
            "positive_inv": 0.49700927734375,
            "negative_inv": 0.509918212890625,
            "overall": 0.5031585693359375
          },
          "stages.1.blocks.0.tm": {
            "positive": 0.491241455078125,
            "negative": 0.496490478515625,
            "positive_inv": 0.514678955078125,
            "negative_inv": 0.519927978515625,
            "overall": 0.505584716796875
          },
          "stages.1.blocks.1.tm": {
            "positive": 0.518035888671875,
            "negative": 0.515625,
            "positive_inv": 0.510284423828125,
            "negative_inv": 0.5107421875,
            "overall": 0.513671875
          },
          "stages.1.head_tm": {
            "positive": 0.487274169921875,
            "negative": 0.49078369140625,
            "positive_inv": 0.48687744140625,
            "negative_inv": 0.491363525390625,
            "overall": 0.48907470703125
          },
          "stages.2.blocks.0.tm": {
            "positive": 0.547210693359375,
            "negative": 0.546173095703125,
            "positive_inv": 0.542999267578125,
            "negative_inv": 0.54827880859375,
            "overall": 0.5461654663085938
          },
          "stages.2.blocks.1.tm": {
            "positive": 0.54974365234375,
            "negative": 0.551422119140625,
            "positive_inv": 0.54534912109375,
            "negative_inv": 0.54132080078125,
            "overall": 0.5469589233398438
          },
          "stages.2.blocks.2.tm": {
            "positive": 0.547332763671875,
            "negative": 0.547943115234375,
            "positive_inv": 0.55316162109375,
            "negative_inv": 0.541412353515625,
            "overall": 0.5474624633789062
          },
          "stages.2.blocks.3.tm": {
            "positive": 0.551239013671875,
            "negative": 0.551910400390625,
            "positive_inv": 0.54388427734375,
            "negative_inv": 0.546783447265625,
            "overall": 0.5484542846679688
          },
          "stages.2.head_tm": {
            "positive": 0.476898193359375,
            "negative": 0.475799560546875,
            "positive_inv": 0.475128173828125,
            "negative_inv": 0.477294921875,
            "overall": 0.47628021240234375
          },
          "stages.3.blocks.0.tm": {
            "positive": 0.521392822265625,
            "negative": 0.517333984375,
            "positive_inv": 0.51507568359375,
            "negative_inv": 0.517486572265625,
            "overall": 0.517822265625
          },
          "stages.3.blocks.1.tm": {
            "positive": 0.518035888671875,
            "negative": 0.514984130859375,
            "positive_inv": 0.515777587890625,
            "negative_inv": 0.51763916015625,
            "overall": 0.5166091918945312
          },
          "stages.3.head_tm": {
            "positive": 0.481597900390625,
            "negative": 0.478302001953125,
            "positive_inv": 0.47113037109375,
            "negative_inv": 0.473724365234375,
            "overall": 0.47618865966796875
          },
          "head": {
            "positive": 0.481170654296875,
            "negative": 0.483642578125,
            "positive_inv": 0.484588623046875,
            "negative_inv": 0.48388671875,
            "overall": 0.4833221435546875
          }
        },
        "attention": {
          "root": [
            0.14366702735424042,
            0.17038552463054657,
            0.2493356615304947,
            0.2277800440788269,
            0.2088318020105362
          ]
        }
      },
      "extra": {
        "lr": 0.0005,
        "best_test_acc": 0.4752,
        "world_size": 1,
        "stage_acc_0": 0.1567,
        "stage_acc_1": 0.1923,
        "stage_acc_2": 0.3051,
        "stage_acc_3": 0.1428,
        "stage_acc_4": 0.1675,
        "attention_0": 0.14366701245307922,
        "attention_1": 0.17038552463054657,
        "attention_2": 0.24933569133281708,
        "attention_3": 0.2277800738811493,
        "attention_4": 0.2088318169116974,
        "attention_scale_acc": 0.2517,
        "attention_clause_acc": 0.4034
      }
    }
  ]
}